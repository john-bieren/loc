# loc

A command line utility for recursively counting lines of code in directories and their subdirectories by language.

### Example output

<pre>
<code><b>Language: loc | size | files</b>
7 langs: 12,231 | 714.7 kb | 53
Python: 11,392 | 684.1 kb | 44
C++: 351 | 14.3 kb | 2
C: 323 | 11.4 kb | 2
Go: 72 | 1.9 kb | 1
Ruby: 33 | 1.1 kb | 1
Shell: 32 | 938 b | 1
Powershell: 28 | 939 b | 2
</code></pre>

## Install

1. Clone the repository:
    ```
    git clone https://github.com/john-bieren/loc.git
    ```
2. Navigate to the project directory and compile the program:
    ```
    go build
    ```

## Usage

This usage information can be found with `loc --help`:

```
Usage: loc [options] [dirs]
         Options must come before dirs
         Dirs are the names/paths of directories to search (cwd by default)

Options:
        -d        Print loc by directory
             -pd int   Maximum depth of subdirectories to print (default: 1,000)
        -ed str   Directories to exclude (name or path, i.e. "lib,src/utils")
        -ef str   Files to exclude (name or path, i.e. "index.js,src/main.go")
        -el str   Languages to exclude (i.e. "HTML,Plain Text,JSON")
        -f        Print loc by file
             -mf int   Maximum number of files to print per directory (default: 100,000)
        -id       Include dot directories (excluded by default)
        -if str   Files to include (name or path, i.e. "main.py,src/main.c")
        -il str   Languages to include, all others excluded (i.e. "Python,JavaScript,C")
        -ml int   Maximum number of languages to print per directory (default: 1,000)
        -p        Print loc as a percentage of overall total
        -s  str   Choose how to sort results ["loc", "size", "files"] (default: "loc")
        -sd int   Maximum depth of subdirectories to search (default: 1,000)
```

## Limitations

I'm new to Go, and this is just a personal project. As such, loc has some noteworthy limitations:
* No concurrency, at least not yet.
* Multi-line comments and non-comment docstrings are counted as as lines of code.
* Language information comes from [scc](https://github.com/boyter/scc/blob/master/languages.json) and is stored in `languages.go`, which is generated by `generator.go`. You can pull changes from scc by running `go generate` and re-compiling the program with `go build`.
* Files are assigned a language based only on their extension, resulting in a few conflicts where the language cannot be fully identified. `generator.go` resolves these conflicts by mapping extensions to "lang_1 or lang_2".

There are similar, more advanced programs, like scc, with more features and better methods for counting lines of code.

## Custom mappings

loc uses three maps, located in `languages.go`, to store language information:
* `extensions`, which maps extensions to languages
* `filenames`, which maps specific file names to languages
* `single_line_comment_chars`, which maps languages to a list of their single-line comment characters

If you install from source and want to add/overwrite key-value pairs in these maps, `generator.go` can process these custom mappings. In the project directory, create a file named `custom_mappings.json` and list your mappings as shown below (shown are the custom mappings used in this repo):
```JSON
{
    "extensions": {
        "HC": "HolyC",
        "hc": "HolyC",
        "heex": "HEEx",
        "json": "JSON",
        "yaml": "YAML",
        "yml": "YAML"
    },
    "filenames": {
        "LICENCE": "License",
        "LICENSE": "License",
        "LICENCE.txt": "License",
        "LICENSE.txt": "License",
        "README": "README",
        "README.md": "README"
    },
    "single_line_comment_chars": {
        "HolyC": ["//"]
    }
}
```
Run `go generate` to apply your custom mappings to `languages.go`, then run `go build` to re-compile the program with the new mappings.
